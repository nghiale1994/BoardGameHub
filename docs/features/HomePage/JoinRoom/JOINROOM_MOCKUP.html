<!DOCTYPE html>
<!-- NOTE: AI must read docs/ai/README.md before modifying this file. -->
<!-- Version: 2026-01-31 | Changelog: Created standalone JoinRoom mockup aligned with HomePage design (spectator checkbox, URL validation + error message, disabled Join when invalid/empty, invite URL auto-paste + scrollIntoView). -->
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BoardGame Hub - JoinRoom Mockup</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --color-primary: #ff3b81;
      --color-primary-light: #ff6fa3;
      --color-surface: #ffffff;
      --color-surface-dark: #fff6f9;
      --color-bg: linear-gradient(180deg, #fff7fb 0%, #fffef6 100%);
      --color-text-primary: #0b1020;
      --color-text-secondary: #4b5563;
      --color-border: rgba(11,16,32,0.10);
      --radius: 0.75rem;
      --spacing-sm: 1rem;
      --spacing-md: 1.5rem;
      --spacing-lg: 2rem;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: var(--color-bg);
      color: var(--color-text-primary);
      padding: var(--spacing-lg);
      min-height: 100vh;
    }

    .topbar {
      max-width: 820px;
      margin: 0 auto var(--spacing-md);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: var(--spacing-md);
    }

    .title h1 { font-size: 1.25rem; }
    .title p { color: var(--color-text-secondary); margin-top: 0.25rem; }

    .back-link {
      text-decoration: none;
      color: var(--color-text-primary);
      border: 1px solid var(--color-border);
      background: rgba(255,255,255,0.6);
      padding: 0.6rem 0.9rem;
      border-radius: 999px;
    }

    .card {
      max-width: 820px;
      margin: 0 auto;
      background: rgba(255,255,255,0.85);
      border: 1px solid var(--color-border);
      border-radius: var(--radius);
      padding: var(--spacing-lg);
      box-shadow: 0 10px 30px rgba(11,16,32,0.08);
      backdrop-filter: blur(6px);
    }

    .section-title { font-weight: 900; font-size: 1.1rem; }

    .field {
      margin-top: var(--spacing-md);
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .label { font-size: 0.95rem; font-weight: 700; }

    .url-input {
      padding: 0.9rem 1rem;
      border-radius: 12px;
      border: 1px solid var(--color-border);
      background: var(--color-surface);
      outline: none;
      font-size: 1rem;
    }

    .url-input.invalid {
      border-color: rgba(239, 68, 68, 0.6);
      box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.12);
    }

    .hint { color: var(--color-text-secondary); font-size: 0.9rem; }

    .error { color: #ef4444; font-size: 0.9rem; display: none; }

    .spectator-row {
      margin-top: var(--spacing-md);
      display: flex;
      align-items: center;
      gap: 0.75rem;
      color: var(--color-text-secondary);
    }

    .spectator-row input { width: 18px; height: 18px; }

    .actions {
      margin-top: var(--spacing-md);
      display: flex;
      gap: 0.75rem;
      justify-content: flex-end;
      flex-wrap: wrap;
    }

    .btn {
      padding: 0.9rem 1.1rem;
      border-radius: 999px;
      border: 1px solid var(--color-border);
      background: rgba(255,255,255,0.8);
      cursor: pointer;
      font-weight: 800;
    }

    .btn-primary {
      background: var(--color-primary);
      border-color: rgba(255,59,129,0.55);
      color: white;
    }

    .btn-primary:disabled {
      background: rgba(255,59,129,0.45);
      cursor: not-allowed;
    }

    .invite-note {
      margin-top: var(--spacing-md);
      padding: 0.9rem 1rem;
      border-radius: 12px;
      background: var(--color-surface-dark);
      border: 1px dashed rgba(11,16,32,0.18);
      color: var(--color-text-secondary);
      font-size: 0.95rem;
    }

    code { background: rgba(11,16,32,0.06); padding: 0.1rem 0.3rem; border-radius: 6px; }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="title">
      <h1>JoinRoom Mockup</h1>
      <p>Dán link phòng và tham gia (player/spectator)</p>
    </div>
    <a class="back-link" href="../MOCKUP_INDEX.html" target="_blank">← Quay về Index</a>
  </div>

  <div id="joinRoomSection" class="card">
    <div class="section-title">Tham gia phòng</div>

    <div class="field">
      <div class="label">Liên kết phòng</div>
      <input id="roomUrl" class="url-input" type="text" placeholder="Dán liên kết phòng" aria-describedby="urlHint urlError" />
      <div id="urlHint" class="hint" style="display:none;">Từ liên kết mời</div>
      <div id="urlError" class="error">Liên kết phòng không hợp lệ</div>
      <div class="hint">Ví dụ: <code>https://boardgamehub.com/i/ABC123</code></div>
    </div>

    <label class="spectator-row">
      <input id="spectatorMode" type="checkbox" />
      Tham gia với tư cách khán giả
    </label>

    <div class="actions">
      <button id="joinBtn" class="btn btn-primary" disabled>Tham gia</button>
    </div>

    <div class="invite-note">
      Invite URL behavior: nếu mở URL dạng <code>/i/:roomId</code>, trang sẽ auto-scroll đến JoinRoom và auto-fill input.
    </div>
  </div>

  <script>
    const ROOM_URL_RE = /\/(?:i|r)\/([A-Za-z0-9_-]{3,})/;

    const el = (id) => document.getElementById(id);

    function extractRoomIdFromText(text) {
      const value = (text || '').trim();
      if (!value) return null;
      const match = value.match(ROOM_URL_RE);
      return match ? match[1] : null;
    }

    function setValidationState() {
      const input = el('roomUrl');
      const error = el('urlError');
      const joinBtn = el('joinBtn');

      const roomId = extractRoomIdFromText(input.value);
      const hasText = !!input.value.trim();
      const isValid = !!roomId;

      input.classList.toggle('invalid', hasText && !isValid);
      error.style.display = (hasText && !isValid) ? 'block' : 'none';
      joinBtn.disabled = !isValid;
    }

    function joinRoom() {
      const url = el('roomUrl').value;
      const roomId = extractRoomIdFromText(url);
      setValidationState();
      if (!roomId) return;

      const isSpectator = el('spectatorMode').checked;
      const mode = isSpectator ? 'khán giả' : 'người chơi';
      alert(`Tham gia phòng: ${url} (roomId: ${roomId}, mode: ${mode})`);
    }

    el('roomUrl').addEventListener('input', setValidationState);
    el('roomUrl').addEventListener('blur', setValidationState);
    el('joinBtn').addEventListener('click', joinRoom);

    // Invite URL auto-paste + auto-scroll (scrollIntoView)
    window.addEventListener('load', () => {
      const path = window.location.pathname || '';
      const hash = window.location.hash || '';
      const match = path.match(/\/(?:i|r)\/([^\/?#]+)/) || hash.match(/\/(?:i|r)\/([^\/?#]+)/);
      if (!match) {
        setValidationState();
        return;
      }

      const roomId = match[1];
      const shareUrl = `https://boardgamehub.com/i/${roomId}`;
      el('roomUrl').value = shareUrl;
      el('roomUrl').readOnly = true;
      el('urlHint').style.display = 'block';

      el('joinRoomSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
      el('roomUrl').focus();
      setValidationState();
    });
  </script>
</body>
</html>
